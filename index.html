<!DOCTYPE html>
<html>
<head>
    <title>AI Initiatives Timeline</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f4f4f4;
        }

        #visualization {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-top: 20px;
        }

        .checkbox-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            background-color: #f0f0f0;
            padding: 5px 10px;
            border-radius: 20px;
            transition: background-color 0.3s;
        }

        .checkbox-label:hover {
            background-color: #e0e0e0;
        }

        .button-container button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            transition-duration: 0.4s;
            cursor: pointer;
            border-radius: 5px;
        }

        .button-container button:hover {
            background-color: #45a049;
        }

        .vis-item {
            border-radius: 5px;
            padding: 5px 10px;
        }

        .vis-item .vis-item-content {
            padding: 5px;
        }

/* Add more custom styles for your timeline items here */

        #visualization {
            width: 100%;
            height: 100%;
            border: 1px solid lightgray;
            overflow: auto;
        }
        .vis-item.launched { background-color: #5cb85c !important; color: white !important; border: 1px solid #4cae4c !important; }
        .vis-item.executiveLeadership { background-color: #5bc0de !important; color: white !important; border: 1px solid #46b8da !important; }
        .vis-item.globalSummits { background-color: #a0522d !important; color: white !important; border: 1px solid #8b4513 !important; }
        .vis-item.other { background-color: #696969 !important; color: white !important; border: 1px solid #585858 !important; }
        .vis-item.regulationPolicy { background-color: #ffd700 !important; color: black !important; border: 1px solid #ffd700 !important; }
        .checkbox-container { margin: 10px 0; }
        .checkbox-label { margin-right: 10px; display: inline-block; }
        .button-container { margin: 10px 0; }

        .checkbox-label::before { content: ''; display: inline-block; width: 20px; height: 20px; margin-right: 5px; }
        .launched-checkbox::before { background-color: #5cb85c; }
        .executiveLeadership-checkbox::before { background-color: #5bc0de; }
        .regulationPolicy-checkbox::before { background-color: #ffd700; }
        .globalSummits-checkbox::before { background-color: #a0522d; }
        .other-checkbox::before { background-color: #696969; }

        .checkbox-label::before {
            content: '';
            display: inline-block;
            width: 30px;
            height: 20px;
            margin-right: 5px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .uk-checkbox::before { background-image: url('https://upload.wikimedia.org/wikipedia/en/a/ae/Flag_of_the_United_Kingdom.svg'); }
        .us-checkbox::before { background-image: url('https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg'); }
        .eu-checkbox::before { background-image: url('https://upload.wikimedia.org/wikipedia/commons/b/b7/Flag_of_Europe.svg'); }
        .japan-checkbox::before { background-image: url('https://upload.wikimedia.org/wikipedia/en/9/9e/Flag_of_Japan.svg'); }
        .singapore-checkbox::before { background-image: url('https://upload.wikimedia.org/wikipedia/commons/4/48/Flag_of_Singapore.svg'); }
        .france-checkbox::before { background-image: url('https://upload.wikimedia.org/wikipedia/en/c/c3/Flag_of_France.svg'); }
        .canada-checkbox::before { background-image: url('https://upload.wikimedia.org/wikipedia/en/c/cf/Flag_of_Canada.svg'); }
        .south-korea-checkbox::before { background-image: url('https://upload.wikimedia.org/wikipedia/commons/0/09/Flag_of_South_Korea.svg'); }
        .global-checkbox::before { content: 'üåç'; font-size: 20px; }


    </style>
    <script>
        const webAppUrl = 'https://script.google.com/macros/s/AKfycbx0N9RqS_GPskzoTfaSlMBXsZtlQ4IH3SLeg_hYmOE2dJcXtUkFjcxl1e-HE5samNAFvA/exec';
        
        async function fetchWebAppData(url) {
            const response = await fetch(url);
            const data = await response.json();
            return data;
        }

        async function updateAllItems() {
            const data = await fetchWebAppData(webAppUrl);
            allItems = data.map(item => ({
                id: parseInt(item.id),
                content: item.content,
                start: item.start,
                group: item.group,
                categories: item.categories.split(';'),
                className: item.className,
                link: item.link
            }));
            console.log(allItems);

            var items = new vis.DataSet(allItems);

            var options = {
                groupOrder: function (a, b) {
                    var order = ['UK', 'US', 'EU', 'Japan', 'Singapore', 'France', 'Canada', 'South Korea', 'Global'];
                    return order.indexOf(a.content) - order.indexOf(b.content);
                },
                zoomable: true,
                zoomMin: 1000 * 60 * 60 * 24 * 30 * 3,
                zoomMax: 1000 * 60 * 60 * 24 * 365 * 4,
                zoomKey: 'ctrlKey',
                moveable: true 
            };

            var container = document.getElementById('visualization');
            var groups = new vis.DataSet([
                { id: 'UK', content: '<img src="https://upload.wikimedia.org/wikipedia/en/a/ae/Flag_of_the_United_Kingdom.svg" style="width:20px; vertical-align:middle;"> UK', style: 'background-color: #00247d; color: white;' },
                { id: 'US', content: '<img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="width:20px; vertical-align:middle;"> US', style: 'background-color: #b22234; color: white;' },
                { id: 'EU', content: '<img src="https://upload.wikimedia.org/wikipedia/commons/b/b7/Flag_of_Europe.svg" style="width:20px; vertical-align:middle;"> EU', style: 'background-color: #337ab7; color: white;' },
                { id: 'Japan', content: '<img src="https://upload.wikimedia.org/wikipedia/en/9/9e/Flag_of_Japan.svg" style="width:20px; vertical-align:middle;"> Japan', style: 'background-color: #f7b924; color: white;' },
                { id: 'Singapore', content: '<img src="https://upload.wikimedia.org/wikipedia/commons/4/48/Flag_of_Singapore.svg" style="width:20px; vertical-align:middle;"> Singapore', style: 'background-color: #d9534f; color: white;' },
                { id: 'France', content: '<img src="https://upload.wikimedia.org/wikipedia/en/c/c3/Flag_of_France.svg" style="width:20px; vertical-align:middle;"> France', style: 'background-color: #5e35b1; color: white;' },
                { id: 'Canada', content: '<img src="https://upload.wikimedia.org/wikipedia/en/c/cf/Flag_of_Canada.svg" style="width:20px; vertical-align:middle;"> Canada', style: 'background-color: #ff7043; color: white;' },
                { id: 'South Korea', content: '<img src="https://upload.wikimedia.org/wikipedia/commons/0/09/Flag_of_South_Korea.svg" style="width:20px; vertical-align:middle;"> South Korea', style: 'background-color: #26a69a; color: white;' },
                { id: 'Global', content: 'üåç Global', style: 'background-color: #9e9e9e; color: white;' }
            ]);

            var timeline = new vis.Timeline(container, items, groups, options);

            timeline.on('select', function (properties) {
                var item = items.get(properties.items[0]);
                if (item && item.link) {
                    window.open(item.link, '_blank');
                }
            });

            document.querySelectorAll('.filter-checkbox').forEach(function (checkbox) {
                checkbox.addEventListener('change', applyFilters);
            });

            function applyFilters() {
                var selectedCategories = Array.from(document.querySelectorAll('.category:checked')).map(el => el.id);
                var selectedGroups = Array.from(document.querySelectorAll('.group:checked')).map(el => el.id.replace('_', ' '));

                var filteredItems = allItems.filter(function (item) {
                    var categoryMatch = item.categories.some(category => selectedCategories.includes(category));
                    var groupMatch = selectedGroups.includes(item.group);
                    return categoryMatch && groupMatch;
                });

                items.clear();
                items.add(filteredItems);
            }


            document.querySelectorAll('.select-all').forEach(function (button) {
                button.addEventListener('click', function () {
                    selectAll(button.dataset.type);
                });
            });

            document.querySelectorAll('.clear-all').forEach(function (button) {
                button.addEventListener('click', function () {
                    clearAll(button.dataset.type);
                });
            });

            function selectAll(type) {
                document.querySelectorAll('.' + type).forEach(function (checkbox) {
                    checkbox.checked = true;
                });
                applyFilters();
            }

            function clearAll(type) {
                document.querySelectorAll('.' + type).forEach(function (checkbox) {
                    checkbox.checked = false;
                });
                applyFilters();
            }

            applyFilters();
        }

        document.addEventListener('DOMContentLoaded', updateAllItems);
        
        let allItems = [];
    </script>
</head>
<body>
<div class="checkbox-container">
    <div>
        <label class="checkbox-label launched-checkbox"><input type="checkbox" class="filter-checkbox category" id="launched" checked> AISI Launched/Announced</label>
        <label class="checkbox-label executiveLeadership-checkbox"><input type="checkbox" class="filter-checkbox category" id="executiveLeadership" checked> AISI Executive Leadership Announced</label>
        <label class="checkbox-label regulationPolicy-checkbox"><input type="checkbox" class="filter-checkbox category" id="regulationPolicy" checked> Regulation/Policy</label>
        <label class="checkbox-label globalSummits-checkbox"><input type="checkbox" class="filter-checkbox category" id="globalSummits" checked> Global Summits</label>
        <label class="checkbox-label other-checkbox"><input type="checkbox" class="filter-checkbox category" id="other" checked> Other</label>
        
    </div>
    <div class="button-container">
        <button class="select-all" data-type="category">Select All Categories</button>
        <button class="clear-all" data-type="category">Clear All Categories</button>
    </div>
    <div>
        <label class="checkbox-label uk-checkbox"><input type="checkbox" class="filter-checkbox group" id="UK" checked> UK</label>
        <label class="checkbox-label us-checkbox"><input type="checkbox" class="filter-checkbox group" id="US" checked> US</label>
        <label class="checkbox-label eu-checkbox"><input type="checkbox" class="filter-checkbox group" id="EU" checked> EU</label>
        <label class="checkbox-label japan-checkbox"><input type="checkbox" class="filter-checkbox group" id="Japan" checked> Japan</label>
        <label class="checkbox-label singapore-checkbox"><input type="checkbox" class="filter-checkbox group" id="Singapore" checked> Singapore</label>
        <label class="checkbox-label france-checkbox"><input type="checkbox" class="filter-checkbox group" id="France" checked> France</label>
        <label class="checkbox-label canada-checkbox"><input type="checkbox" class="filter-checkbox group" id="Canada" checked> Canada</label>
        <label class="checkbox-label south-korea-checkbox"><input type="checkbox" class="filter-checkbox group" id="South_Korea" checked> South Korea</label>
        <label class="checkbox-label global-checkbox"><input type="checkbox" class="filter-checkbox group" id="Global" checked> üåç Global</label>        
    </div>
    <div class="button-container">
        <button class="select-all" data-type="group">Select All Groups</button>
        <button class="clear-all" data-type="group">Clear All Groups</button>
    </div>
</div>
<div id="visualization"></div>
</body>
</html>
